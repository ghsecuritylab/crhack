/*****************************************************************************/
/*                                                  ###                      */
/*       #####          ###    ###                  ###  CREATE: 2010-01-06  */
/*     #######          ###    ###      [CORE]      ###  ~~~~~~~~~~~~~~~~~~  */
/*    ########          ###    ###                  ###  MODIFY: XXXX-XX-XX  */
/*    ####  ##          ###    ###                  ###  ~~~~~~~~~~~~~~~~~~  */
/*   ###       ### ###  ###    ###    ####    ####  ###   ##  +-----------+  */
/*  ####       ######## ##########  #######  ###### ###  ###  |  A NEW C  |  */
/*  ###        ######## ########## ########  ###### ### ###   | FRAMEWORK |  */
/*  ###     ## #### ### ########## ###  ### ###     ######    |  FOR ALL  |  */
/*  ####   ### ###  ### ###    ### ###  ### ###     ######    | PLATFORMS |  */
/*  ########## ###      ###    ### ######## ####### #######   |  AND ALL  |  */
/*   #######   ###      ###    ### ########  ###### ###  ###  | COMPILERS |  */
/*    #####    ###      ###    ###  #### ##   ####  ###   ##  +-----------+  */
/*  =======================================================================  */
/*  >>>>>>>>>>>>>>>>>>>>> CrHack ANUBIS 加密解密函数库 <<<<<<<<<<<<<<<<<<<<  */
/*  =======================================================================  */
/*****************************************************************************/

#include "crypto.h"
#include "memlib.h"

/* ANUBIS 常数表 */
static const int32u _rom_ s_t0[256] =
{
    0xBA69D2BBUL, 0x54A84DE5UL, 0x2F5EBCE2UL, 0x74E8CD25UL,
    0x53A651F7UL, 0xD3BB6BD0UL, 0xD2B96FD6UL, 0x4D9A29B3UL,
    0x50A05DFDUL, 0xAC458ACFUL, 0x8D070E09UL, 0xBF63C6A5UL,
    0x70E0DD3DUL, 0x52A455F1UL, 0x9A29527BUL, 0x4C982DB5UL,
    0xEAC98F46UL, 0xD5B773C4UL, 0x97336655UL, 0xD1BF63DCUL,
    0x3366CCAAUL, 0x51A259FBUL, 0x5BB671C7UL, 0xA651A2F3UL,
    0xDEA15FFEUL, 0x48903DADUL, 0xA84D9AD7UL, 0x992F5E71UL,
    0xDBAB4BE0UL, 0x3264C8ACUL, 0xB773E695UL, 0xFCE5D732UL,
    0xE3DBAB70UL, 0x9E214263UL, 0x913F7E41UL, 0x9B2B567DUL,
    0xE2D9AF76UL, 0xBB6BD6BDUL, 0x4182199BUL, 0x6EDCA579UL,
    0xA557AEF9UL, 0xCB8B0B80UL, 0x6BD6B167UL, 0x95376E59UL,
    0xA15FBEE1UL, 0xF3FBEB10UL, 0xB17FFE81UL, 0x0204080CUL,
    0xCC851792UL, 0xC49537A2UL, 0x1D3A744EUL, 0x14285078UL,
    0xC39B2BB0UL, 0x63C69157UL, 0xDAA94FE6UL, 0x5DBA69D3UL,
    0x5FBE61DFUL, 0xDCA557F2UL, 0x7DFAE913UL, 0xCD871394UL,
    0x7FFEE11FUL, 0x5AB475C1UL, 0x6CD8AD75UL, 0x5CB86DD5UL,
    0xF7F3FB08UL, 0x264C98D4UL, 0xFFE3DB38UL, 0xEDC79354UL,
    0xE8CD874AUL, 0x9D274E69UL, 0x6FDEA17FUL, 0x8E010203UL,
    0x19326456UL, 0xA05DBAE7UL, 0xF0FDE71AUL, 0x890F1E11UL,
    0x0F1E3C22UL, 0x070E1C12UL, 0xAF4386C5UL, 0xFBEBCB20UL,
    0x08102030UL, 0x152A547EUL, 0x0D1A342EUL, 0x04081018UL,
    0x01020406UL, 0x64C88D45UL, 0xDFA35BF8UL, 0x76ECC529UL,
    0x79F2F90BUL, 0xDDA753F4UL, 0x3D7AF48EUL, 0x162C5874UL,
    0x3F7EFC82UL, 0x376EDCB2UL, 0x6DDAA973UL, 0x3870E090UL,
    0xB96FDEB1UL, 0x73E6D137UL, 0xE9CF834CUL, 0x356AD4BEUL,
    0x55AA49E3UL, 0x71E2D93BUL, 0x7BF6F107UL, 0x8C050A0FUL,
    0x72E4D531UL, 0x880D1A17UL, 0xF6F1FF0EUL, 0x2A54A8FCUL,
    0x3E7CF884UL, 0x5EBC65D9UL, 0x274E9CD2UL, 0x468C0589UL,
    0x0C183028UL, 0x65CA8943UL, 0x68D0BD6DUL, 0x61C2995BUL,
    0x03060C0AUL, 0xC19F23BCUL, 0x57AE41EFUL, 0xD6B17FCEUL,
    0xD9AF43ECUL, 0x58B07DCDUL, 0xD8AD47EAUL, 0x66CC8549UL,
    0xD7B37BC8UL, 0x3A74E89CUL, 0xC88D078AUL, 0x3C78F088UL,
    0xFAE9CF26UL, 0x96316253UL, 0xA753A6F5UL, 0x982D5A77UL,
    0xECC59752UL, 0xB86DDAB7UL, 0xC7933BA8UL, 0xAE4182C3UL,
    0x69D2B96BUL, 0x4B9631A7UL, 0xAB4B96DDUL, 0xA94F9ED1UL,
    0x67CE814FUL, 0x0A14283CUL, 0x478E018FUL, 0xF2F9EF16UL,
    0xB577EE99UL, 0x224488CCUL, 0xE5D7B364UL, 0xEEC19F5EUL,
    0xBE61C2A3UL, 0x2B56ACFAUL, 0x811F3E21UL, 0x1224486CUL,
    0x831B362DUL, 0x1B366C5AUL, 0x0E1C3824UL, 0x23468CCAUL,
    0xF5F7F304UL, 0x458A0983UL, 0x214284C6UL, 0xCE811F9EUL,
    0x499239ABUL, 0x2C58B0E8UL, 0xF9EFC32CUL, 0xE6D1BF6EUL,
    0xB671E293UL, 0x2850A0F0UL, 0x172E5C72UL, 0x8219322BUL,
    0x1A34685CUL, 0x8B0B161DUL, 0xFEE1DF3EUL, 0x8A09121BUL,
    0x09122436UL, 0xC98F038CUL, 0x87132635UL, 0x4E9C25B9UL,
    0xE1DFA37CUL, 0x2E5CB8E4UL, 0xE4D5B762UL, 0xE0DDA77AUL,
    0xEBCB8B40UL, 0x903D7A47UL, 0xA455AAFFUL, 0x1E3C7844UL,
    0x85172E39UL, 0x60C09D5DUL, 0x00000000UL, 0x254A94DEUL,
    0xF4F5F702UL, 0xF1FFE31CUL, 0x94356A5FUL, 0x0B162C3AUL,
    0xE7D3BB68UL, 0x75EAC923UL, 0xEFC39B58UL, 0x3468D0B8UL,
    0x3162C4A6UL, 0xD4B577C2UL, 0xD0BD67DAUL, 0x86112233UL,
    0x7EFCE519UL, 0xAD478EC9UL, 0xFDE7D334UL, 0x2952A4F6UL,
    0x3060C0A0UL, 0x3B76EC9AUL, 0x9F234665UL, 0xF8EDC72AUL,
    0xC6913FAEUL, 0x13264C6AUL, 0x060C1814UL, 0x050A141EUL,
    0xC59733A4UL, 0x11224466UL, 0x77EEC12FUL, 0x7CF8ED15UL,
    0x7AF4F501UL, 0x78F0FD0DUL, 0x366CD8B4UL, 0x1C387048UL,
    0x3972E496UL, 0x59B279CBUL, 0x18306050UL, 0x56AC45E9UL,
    0xB37BF68DUL, 0xB07DFA87UL, 0x244890D8UL, 0x204080C0UL,
    0xB279F28BUL, 0x9239724BUL, 0xA35BB6EDUL, 0xC09D27BAUL,
    0x44880D85UL, 0x62C49551UL, 0x10204060UL, 0xB475EA9FUL,
    0x84152A3FUL, 0x43861197UL, 0x933B764DUL, 0xC2992FB6UL,
    0x4A9435A1UL, 0xBD67CEA9UL, 0x8F030605UL, 0x2D5AB4EEUL,
    0xBC65CAAFUL, 0x9C254A6FUL, 0x6AD4B561UL, 0x40801D9DUL,
    0xCF831B98UL, 0xA259B2EBUL, 0x801D3A27UL, 0x4F9E21BFUL,
    0x1F3E7C42UL, 0xCA890F86UL, 0xAA4992DBUL, 0x42841591UL,
};

static const int32u _rom_ s_t1[256] =
{
    0x69BABBD2UL, 0xA854E54DUL, 0x5E2FE2BCUL, 0xE87425CDUL,
    0xA653F751UL, 0xBBD3D06BUL, 0xB9D2D66FUL, 0x9A4DB329UL,
    0xA050FD5DUL, 0x45ACCF8AUL, 0x078D090EUL, 0x63BFA5C6UL,
    0xE0703DDDUL, 0xA452F155UL, 0x299A7B52UL, 0x984CB52DUL,
    0xC9EA468FUL, 0xB7D5C473UL, 0x33975566UL, 0xBFD1DC63UL,
    0x6633AACCUL, 0xA251FB59UL, 0xB65BC771UL, 0x51A6F3A2UL,
    0xA1DEFE5FUL, 0x9048AD3DUL, 0x4DA8D79AUL, 0x2F99715EUL,
    0xABDBE04BUL, 0x6432ACC8UL, 0x73B795E6UL, 0xE5FC32D7UL,
    0xDBE370ABUL, 0x219E6342UL, 0x3F91417EUL, 0x2B9B7D56UL,
    0xD9E276AFUL, 0x6BBBBDD6UL, 0x82419B19UL, 0xDC6E79A5UL,
    0x57A5F9AEUL, 0x8BCB800BUL, 0xD66B67B1UL, 0x3795596EUL,
    0x5FA1E1BEUL, 0xFBF310EBUL, 0x7FB181FEUL, 0x04020C08UL,
    0x85CC9217UL, 0x95C4A237UL, 0x3A1D4E74UL, 0x28147850UL,
    0x9BC3B02BUL, 0xC6635791UL, 0xA9DAE64FUL, 0xBA5DD369UL,
    0xBE5FDF61UL, 0xA5DCF257UL, 0xFA7D13E9UL, 0x87CD9413UL,
    0xFE7F1FE1UL, 0xB45AC175UL, 0xD86C75ADUL, 0xB85CD56DUL,
    0xF3F708FBUL, 0x4C26D498UL, 0xE3FF38DBUL, 0xC7ED5493UL,
    0xCDE84A87UL, 0x279D694EUL, 0xDE6F7FA1UL, 0x018E0302UL,
    0x32195664UL, 0x5DA0E7BAUL, 0xFDF01AE7UL, 0x0F89111EUL,
    0x1E0F223CUL, 0x0E07121CUL, 0x43AFC586UL, 0xEBFB20CBUL,
    0x10083020UL, 0x2A157E54UL, 0x1A0D2E34UL, 0x08041810UL,
    0x02010604UL, 0xC864458DUL, 0xA3DFF85BUL, 0xEC7629C5UL,
    0xF2790BF9UL, 0xA7DDF453UL, 0x7A3D8EF4UL, 0x2C167458UL,
    0x7E3F82FCUL, 0x6E37B2DCUL, 0xDA6D73A9UL, 0x703890E0UL,
    0x6FB9B1DEUL, 0xE67337D1UL, 0xCFE94C83UL, 0x6A35BED4UL,
    0xAA55E349UL, 0xE2713BD9UL, 0xF67B07F1UL, 0x058C0F0AUL,
    0xE47231D5UL, 0x0D88171AUL, 0xF1F60EFFUL, 0x542AFCA8UL,
    0x7C3E84F8UL, 0xBC5ED965UL, 0x4E27D29CUL, 0x8C468905UL,
    0x180C2830UL, 0xCA654389UL, 0xD0686DBDUL, 0xC2615B99UL,
    0x06030A0CUL, 0x9FC1BC23UL, 0xAE57EF41UL, 0xB1D6CE7FUL,
    0xAFD9EC43UL, 0xB058CD7DUL, 0xADD8EA47UL, 0xCC664985UL,
    0xB3D7C87BUL, 0x743A9CE8UL, 0x8DC88A07UL, 0x783C88F0UL,
    0xE9FA26CFUL, 0x31965362UL, 0x53A7F5A6UL, 0x2D98775AUL,
    0xC5EC5297UL, 0x6DB8B7DAUL, 0x93C7A83BUL, 0x41AEC382UL,
    0xD2696BB9UL, 0x964BA731UL, 0x4BABDD96UL, 0x4FA9D19EUL,
    0xCE674F81UL, 0x140A3C28UL, 0x8E478F01UL, 0xF9F216EFUL,
    0x77B599EEUL, 0x4422CC88UL, 0xD7E564B3UL, 0xC1EE5E9FUL,
    0x61BEA3C2UL, 0x562BFAACUL, 0x1F81213EUL, 0x24126C48UL,
    0x1B832D36UL, 0x361B5A6CUL, 0x1C0E2438UL, 0x4623CA8CUL,
    0xF7F504F3UL, 0x8A458309UL, 0x4221C684UL, 0x81CE9E1FUL,
    0x9249AB39UL, 0x582CE8B0UL, 0xEFF92CC3UL, 0xD1E66EBFUL,
    0x71B693E2UL, 0x5028F0A0UL, 0x2E17725CUL, 0x19822B32UL,
    0x341A5C68UL, 0x0B8B1D16UL, 0xE1FE3EDFUL, 0x098A1B12UL,
    0x12093624UL, 0x8FC98C03UL, 0x13873526UL, 0x9C4EB925UL,
    0xDFE17CA3UL, 0x5C2EE4B8UL, 0xD5E462B7UL, 0xDDE07AA7UL,
    0xCBEB408BUL, 0x3D90477AUL, 0x55A4FFAAUL, 0x3C1E4478UL,
    0x1785392EUL, 0xC0605D9DUL, 0x00000000UL, 0x4A25DE94UL,
    0xF5F402F7UL, 0xFFF11CE3UL, 0x35945F6AUL, 0x160B3A2CUL,
    0xD3E768BBUL, 0xEA7523C9UL, 0xC3EF589BUL, 0x6834B8D0UL,
    0x6231A6C4UL, 0xB5D4C277UL, 0xBDD0DA67UL, 0x11863322UL,
    0xFC7E19E5UL, 0x47ADC98EUL, 0xE7FD34D3UL, 0x5229F6A4UL,
    0x6030A0C0UL, 0x763B9AECUL, 0x239F6546UL, 0xEDF82AC7UL,
    0x91C6AE3FUL, 0x26136A4CUL, 0x0C061418UL, 0x0A051E14UL,
    0x97C5A433UL, 0x22116644UL, 0xEE772FC1UL, 0xF87C15EDUL,
    0xF47A01F5UL, 0xF0780DFDUL, 0x6C36B4D8UL, 0x381C4870UL,
    0x723996E4UL, 0xB259CB79UL, 0x30185060UL, 0xAC56E945UL,
    0x7BB38DF6UL, 0x7DB087FAUL, 0x4824D890UL, 0x4020C080UL,
    0x79B28BF2UL, 0x39924B72UL, 0x5BA3EDB6UL, 0x9DC0BA27UL,
    0x8844850DUL, 0xC4625195UL, 0x20106040UL, 0x75B49FEAUL,
    0x15843F2AUL, 0x86439711UL, 0x3B934D76UL, 0x99C2B62FUL,
    0x944AA135UL, 0x67BDA9CEUL, 0x038F0506UL, 0x5A2DEEB4UL,
    0x65BCAFCAUL, 0x259C6F4AUL, 0xD46A61B5UL, 0x80409D1DUL,
    0x83CF981BUL, 0x59A2EBB2UL, 0x1D80273AUL, 0x9E4FBF21UL,
    0x3E1F427CUL, 0x89CA860FUL, 0x49AADB92UL, 0x84429115UL,
};

static const int32u _rom_ s_t2[256] =
{
    0xD2BBBA69UL, 0x4DE554A8UL, 0xBCE22F5EUL, 0xCD2574E8UL,
    0x51F753A6UL, 0x6BD0D3BBUL, 0x6FD6D2B9UL, 0x29B34D9AUL,
    0x5DFD50A0UL, 0x8ACFAC45UL, 0x0E098D07UL, 0xC6A5BF63UL,
    0xDD3D70E0UL, 0x55F152A4UL, 0x527B9A29UL, 0x2DB54C98UL,
    0x8F46EAC9UL, 0x73C4D5B7UL, 0x66559733UL, 0x63DCD1BFUL,
    0xCCAA3366UL, 0x59FB51A2UL, 0x71C75BB6UL, 0xA2F3A651UL,
    0x5FFEDEA1UL, 0x3DAD4890UL, 0x9AD7A84DUL, 0x5E71992FUL,
    0x4BE0DBABUL, 0xC8AC3264UL, 0xE695B773UL, 0xD732FCE5UL,
    0xAB70E3DBUL, 0x42639E21UL, 0x7E41913FUL, 0x567D9B2BUL,
    0xAF76E2D9UL, 0xD6BDBB6BUL, 0x199B4182UL, 0xA5796EDCUL,
    0xAEF9A557UL, 0x0B80CB8BUL, 0xB1676BD6UL, 0x6E599537UL,
    0xBEE1A15FUL, 0xEB10F3FBUL, 0xFE81B17FUL, 0x080C0204UL,
    0x1792CC85UL, 0x37A2C495UL, 0x744E1D3AUL, 0x50781428UL,
    0x2BB0C39BUL, 0x915763C6UL, 0x4FE6DAA9UL, 0x69D35DBAUL,
    0x61DF5FBEUL, 0x57F2DCA5UL, 0xE9137DFAUL, 0x1394CD87UL,
    0xE11F7FFEUL, 0x75C15AB4UL, 0xAD756CD8UL, 0x6DD55CB8UL,
    0xFB08F7F3UL, 0x98D4264CUL, 0xDB38FFE3UL, 0x9354EDC7UL,
    0x874AE8CDUL, 0x4E699D27UL, 0xA17F6FDEUL, 0x02038E01UL,
    0x64561932UL, 0xBAE7A05DUL, 0xE71AF0FDUL, 0x1E11890FUL,
    0x3C220F1EUL, 0x1C12070EUL, 0x86C5AF43UL, 0xCB20FBEBUL,
    0x20300810UL, 0x547E152AUL, 0x342E0D1AUL, 0x10180408UL,
    0x04060102UL, 0x8D4564C8UL, 0x5BF8DFA3UL, 0xC52976ECUL,
    0xF90B79F2UL, 0x53F4DDA7UL, 0xF48E3D7AUL, 0x5874162CUL,
    0xFC823F7EUL, 0xDCB2376EUL, 0xA9736DDAUL, 0xE0903870UL,
    0xDEB1B96FUL, 0xD13773E6UL, 0x834CE9CFUL, 0xD4BE356AUL,
    0x49E355AAUL, 0xD93B71E2UL, 0xF1077BF6UL, 0x0A0F8C05UL,
    0xD53172E4UL, 0x1A17880DUL, 0xFF0EF6F1UL, 0xA8FC2A54UL,
    0xF8843E7CUL, 0x65D95EBCUL, 0x9CD2274EUL, 0x0589468CUL,
    0x30280C18UL, 0x894365CAUL, 0xBD6D68D0UL, 0x995B61C2UL,
    0x0C0A0306UL, 0x23BCC19FUL, 0x41EF57AEUL, 0x7FCED6B1UL,
    0x43ECD9AFUL, 0x7DCD58B0UL, 0x47EAD8ADUL, 0x854966CCUL,
    0x7BC8D7B3UL, 0xE89C3A74UL, 0x078AC88DUL, 0xF0883C78UL,
    0xCF26FAE9UL, 0x62539631UL, 0xA6F5A753UL, 0x5A77982DUL,
    0x9752ECC5UL, 0xDAB7B86DUL, 0x3BA8C793UL, 0x82C3AE41UL,
    0xB96B69D2UL, 0x31A74B96UL, 0x96DDAB4BUL, 0x9ED1A94FUL,
    0x814F67CEUL, 0x283C0A14UL, 0x018F478EUL, 0xEF16F2F9UL,
    0xEE99B577UL, 0x88CC2244UL, 0xB364E5D7UL, 0x9F5EEEC1UL,
    0xC2A3BE61UL, 0xACFA2B56UL, 0x3E21811FUL, 0x486C1224UL,
    0x362D831BUL, 0x6C5A1B36UL, 0x38240E1CUL, 0x8CCA2346UL,
    0xF304F5F7UL, 0x0983458AUL, 0x84C62142UL, 0x1F9ECE81UL,
    0x39AB4992UL, 0xB0E82C58UL, 0xC32CF9EFUL, 0xBF6EE6D1UL,
    0xE293B671UL, 0xA0F02850UL, 0x5C72172EUL, 0x322B8219UL,
    0x685C1A34UL, 0x161D8B0BUL, 0xDF3EFEE1UL, 0x121B8A09UL,
    0x24360912UL, 0x038CC98FUL, 0x26358713UL, 0x25B94E9CUL,
    0xA37CE1DFUL, 0xB8E42E5CUL, 0xB762E4D5UL, 0xA77AE0DDUL,
    0x8B40EBCBUL, 0x7A47903DUL, 0xAAFFA455UL, 0x78441E3CUL,
    0x2E398517UL, 0x9D5D60C0UL, 0x00000000UL, 0x94DE254AUL,
    0xF702F4F5UL, 0xE31CF1FFUL, 0x6A5F9435UL, 0x2C3A0B16UL,
    0xBB68E7D3UL, 0xC92375EAUL, 0x9B58EFC3UL, 0xD0B83468UL,
    0xC4A63162UL, 0x77C2D4B5UL, 0x67DAD0BDUL, 0x22338611UL,
    0xE5197EFCUL, 0x8EC9AD47UL, 0xD334FDE7UL, 0xA4F62952UL,
    0xC0A03060UL, 0xEC9A3B76UL, 0x46659F23UL, 0xC72AF8EDUL,
    0x3FAEC691UL, 0x4C6A1326UL, 0x1814060CUL, 0x141E050AUL,
    0x33A4C597UL, 0x44661122UL, 0xC12F77EEUL, 0xED157CF8UL,
    0xF5017AF4UL, 0xFD0D78F0UL, 0xD8B4366CUL, 0x70481C38UL,
    0xE4963972UL, 0x79CB59B2UL, 0x60501830UL, 0x45E956ACUL,
    0xF68DB37BUL, 0xFA87B07DUL, 0x90D82448UL, 0x80C02040UL,
    0xF28BB279UL, 0x724B9239UL, 0xB6EDA35BUL, 0x27BAC09DUL,
    0x0D854488UL, 0x955162C4UL, 0x40601020UL, 0xEA9FB475UL,
    0x2A3F8415UL, 0x11974386UL, 0x764D933BUL, 0x2FB6C299UL,
    0x35A14A94UL, 0xCEA9BD67UL, 0x06058F03UL, 0xB4EE2D5AUL,
    0xCAAFBC65UL, 0x4A6F9C25UL, 0xB5616AD4UL, 0x1D9D4080UL,
    0x1B98CF83UL, 0xB2EBA259UL, 0x3A27801DUL, 0x21BF4F9EUL,
    0x7C421F3EUL, 0x0F86CA89UL, 0x92DBAA49UL, 0x15914284UL,
};

static const int32u _rom_ s_t3[256] =
{
    0xBBD269BAUL, 0xE54DA854UL, 0xE2BC5E2FUL, 0x25CDE874UL,
    0xF751A653UL, 0xD06BBBD3UL, 0xD66FB9D2UL, 0xB3299A4DUL,
    0xFD5DA050UL, 0xCF8A45ACUL, 0x090E078DUL, 0xA5C663BFUL,
    0x3DDDE070UL, 0xF155A452UL, 0x7B52299AUL, 0xB52D984CUL,
    0x468FC9EAUL, 0xC473B7D5UL, 0x55663397UL, 0xDC63BFD1UL,
    0xAACC6633UL, 0xFB59A251UL, 0xC771B65BUL, 0xF3A251A6UL,
    0xFE5FA1DEUL, 0xAD3D9048UL, 0xD79A4DA8UL, 0x715E2F99UL,
    0xE04BABDBUL, 0xACC86432UL, 0x95E673B7UL, 0x32D7E5FCUL,
    0x70ABDBE3UL, 0x6342219EUL, 0x417E3F91UL, 0x7D562B9BUL,
    0x76AFD9E2UL, 0xBDD66BBBUL, 0x9B198241UL, 0x79A5DC6EUL,
    0xF9AE57A5UL, 0x800B8BCBUL, 0x67B1D66BUL, 0x596E3795UL,
    0xE1BE5FA1UL, 0x10EBFBF3UL, 0x81FE7FB1UL, 0x0C080402UL,
    0x921785CCUL, 0xA23795C4UL, 0x4E743A1DUL, 0x78502814UL,
    0xB02B9BC3UL, 0x5791C663UL, 0xE64FA9DAUL, 0xD369BA5DUL,
    0xDF61BE5FUL, 0xF257A5DCUL, 0x13E9FA7DUL, 0x941387CDUL,
    0x1FE1FE7FUL, 0xC175B45AUL, 0x75ADD86CUL, 0xD56DB85CUL,
    0x08FBF3F7UL, 0xD4984C26UL, 0x38DBE3FFUL, 0x5493C7EDUL,
    0x4A87CDE8UL, 0x694E279DUL, 0x7FA1DE6FUL, 0x0302018EUL,
    0x56643219UL, 0xE7BA5DA0UL, 0x1AE7FDF0UL, 0x111E0F89UL,
    0x223C1E0FUL, 0x121C0E07UL, 0xC58643AFUL, 0x20CBEBFBUL,
    0x30201008UL, 0x7E542A15UL, 0x2E341A0DUL, 0x18100804UL,
    0x06040201UL, 0x458DC864UL, 0xF85BA3DFUL, 0x29C5EC76UL,
    0x0BF9F279UL, 0xF453A7DDUL, 0x8EF47A3DUL, 0x74582C16UL,
    0x82FC7E3FUL, 0xB2DC6E37UL, 0x73A9DA6DUL, 0x90E07038UL,
    0xB1DE6FB9UL, 0x37D1E673UL, 0x4C83CFE9UL, 0xBED46A35UL,
    0xE349AA55UL, 0x3BD9E271UL, 0x07F1F67BUL, 0x0F0A058CUL,
    0x31D5E472UL, 0x171A0D88UL, 0x0EFFF1F6UL, 0xFCA8542AUL,
    0x84F87C3EUL, 0xD965BC5EUL, 0xD29C4E27UL, 0x89058C46UL,
    0x2830180CUL, 0x4389CA65UL, 0x6DBDD068UL, 0x5B99C261UL,
    0x0A0C0603UL, 0xBC239FC1UL, 0xEF41AE57UL, 0xCE7FB1D6UL,
    0xEC43AFD9UL, 0xCD7DB058UL, 0xEA47ADD8UL, 0x4985CC66UL,
    0xC87BB3D7UL, 0x9CE8743AUL, 0x8A078DC8UL, 0x88F0783CUL,
    0x26CFE9FAUL, 0x53623196UL, 0xF5A653A7UL, 0x775A2D98UL,
    0x5297C5ECUL, 0xB7DA6DB8UL, 0xA83B93C7UL, 0xC38241AEUL,
    0x6BB9D269UL, 0xA731964BUL, 0xDD964BABUL, 0xD19E4FA9UL,
    0x4F81CE67UL, 0x3C28140AUL, 0x8F018E47UL, 0x16EFF9F2UL,
    0x99EE77B5UL, 0xCC884422UL, 0x64B3D7E5UL, 0x5E9FC1EEUL,
    0xA3C261BEUL, 0xFAAC562BUL, 0x213E1F81UL, 0x6C482412UL,
    0x2D361B83UL, 0x5A6C361BUL, 0x24381C0EUL, 0xCA8C4623UL,
    0x04F3F7F5UL, 0x83098A45UL, 0xC6844221UL, 0x9E1F81CEUL,
    0xAB399249UL, 0xE8B0582CUL, 0x2CC3EFF9UL, 0x6EBFD1E6UL,
    0x93E271B6UL, 0xF0A05028UL, 0x725C2E17UL, 0x2B321982UL,
    0x5C68341AUL, 0x1D160B8BUL, 0x3EDFE1FEUL, 0x1B12098AUL,
    0x36241209UL, 0x8C038FC9UL, 0x35261387UL, 0xB9259C4EUL,
    0x7CA3DFE1UL, 0xE4B85C2EUL, 0x62B7D5E4UL, 0x7AA7DDE0UL,
    0x408BCBEBUL, 0x477A3D90UL, 0xFFAA55A4UL, 0x44783C1EUL,
    0x392E1785UL, 0x5D9DC060UL, 0x00000000UL, 0xDE944A25UL,
    0x02F7F5F4UL, 0x1CE3FFF1UL, 0x5F6A3594UL, 0x3A2C160BUL,
    0x68BBD3E7UL, 0x23C9EA75UL, 0x589BC3EFUL, 0xB8D06834UL,
    0xA6C46231UL, 0xC277B5D4UL, 0xDA67BDD0UL, 0x33221186UL,
    0x19E5FC7EUL, 0xC98E47ADUL, 0x34D3E7FDUL, 0xF6A45229UL,
    0xA0C06030UL, 0x9AEC763BUL, 0x6546239FUL, 0x2AC7EDF8UL,
    0xAE3F91C6UL, 0x6A4C2613UL, 0x14180C06UL, 0x1E140A05UL,
    0xA43397C5UL, 0x66442211UL, 0x2FC1EE77UL, 0x15EDF87CUL,
    0x01F5F47AUL, 0x0DFDF078UL, 0xB4D86C36UL, 0x4870381CUL,
    0x96E47239UL, 0xCB79B259UL, 0x50603018UL, 0xE945AC56UL,
    0x8DF67BB3UL, 0x87FA7DB0UL, 0xD8904824UL, 0xC0804020UL,
    0x8BF279B2UL, 0x4B723992UL, 0xEDB65BA3UL, 0xBA279DC0UL,
    0x850D8844UL, 0x5195C462UL, 0x60402010UL, 0x9FEA75B4UL,
    0x3F2A1584UL, 0x97118643UL, 0x4D763B93UL, 0xB62F99C2UL,
    0xA135944AUL, 0xA9CE67BDUL, 0x0506038FUL, 0xEEB45A2DUL,
    0xAFCA65BCUL, 0x6F4A259CUL, 0x61B5D46AUL, 0x9D1D8040UL,
    0x981B83CFUL, 0xEBB259A2UL, 0x273A1D80UL, 0xBF219E4FUL,
    0x427C3E1FUL, 0x860F89CAUL, 0xDB9249AAUL, 0x91158442UL,
};

static const int32u _rom_ s_t4[256] =
{
    0xBABABABAUL, 0x54545454UL, 0x2F2F2F2FUL, 0x74747474UL,
    0x53535353UL, 0xD3D3D3D3UL, 0xD2D2D2D2UL, 0x4D4D4D4DUL,
    0x50505050UL, 0xACACACACUL, 0x8D8D8D8DUL, 0xBFBFBFBFUL,
    0x70707070UL, 0x52525252UL, 0x9A9A9A9AUL, 0x4C4C4C4CUL,
    0xEAEAEAEAUL, 0xD5D5D5D5UL, 0x97979797UL, 0xD1D1D1D1UL,
    0x33333333UL, 0x51515151UL, 0x5B5B5B5BUL, 0xA6A6A6A6UL,
    0xDEDEDEDEUL, 0x48484848UL, 0xA8A8A8A8UL, 0x99999999UL,
    0xDBDBDBDBUL, 0x32323232UL, 0xB7B7B7B7UL, 0xFCFCFCFCUL,
    0xE3E3E3E3UL, 0x9E9E9E9EUL, 0x91919191UL, 0x9B9B9B9BUL,
    0xE2E2E2E2UL, 0xBBBBBBBBUL, 0x41414141UL, 0x6E6E6E6EUL,
    0xA5A5A5A5UL, 0xCBCBCBCBUL, 0x6B6B6B6BUL, 0x95959595UL,
    0xA1A1A1A1UL, 0xF3F3F3F3UL, 0xB1B1B1B1UL, 0x02020202UL,
    0xCCCCCCCCUL, 0xC4C4C4C4UL, 0x1D1D1D1DUL, 0x14141414UL,
    0xC3C3C3C3UL, 0x63636363UL, 0xDADADADAUL, 0x5D5D5D5DUL,
    0x5F5F5F5FUL, 0xDCDCDCDCUL, 0x7D7D7D7DUL, 0xCDCDCDCDUL,
    0x7F7F7F7FUL, 0x5A5A5A5AUL, 0x6C6C6C6CUL, 0x5C5C5C5CUL,
    0xF7F7F7F7UL, 0x26262626UL, 0xFFFFFFFFUL, 0xEDEDEDEDUL,
    0xE8E8E8E8UL, 0x9D9D9D9DUL, 0x6F6F6F6FUL, 0x8E8E8E8EUL,
    0x19191919UL, 0xA0A0A0A0UL, 0xF0F0F0F0UL, 0x89898989UL,
    0x0F0F0F0FUL, 0x07070707UL, 0xAFAFAFAFUL, 0xFBFBFBFBUL,
    0x08080808UL, 0x15151515UL, 0x0D0D0D0DUL, 0x04040404UL,
    0x01010101UL, 0x64646464UL, 0xDFDFDFDFUL, 0x76767676UL,
    0x79797979UL, 0xDDDDDDDDUL, 0x3D3D3D3DUL, 0x16161616UL,
    0x3F3F3F3FUL, 0x37373737UL, 0x6D6D6D6DUL, 0x38383838UL,
    0xB9B9B9B9UL, 0x73737373UL, 0xE9E9E9E9UL, 0x35353535UL,
    0x55555555UL, 0x71717171UL, 0x7B7B7B7BUL, 0x8C8C8C8CUL,
    0x72727272UL, 0x88888888UL, 0xF6F6F6F6UL, 0x2A2A2A2AUL,
    0x3E3E3E3EUL, 0x5E5E5E5EUL, 0x27272727UL, 0x46464646UL,
    0x0C0C0C0CUL, 0x65656565UL, 0x68686868UL, 0x61616161UL,
    0x03030303UL, 0xC1C1C1C1UL, 0x57575757UL, 0xD6D6D6D6UL,
    0xD9D9D9D9UL, 0x58585858UL, 0xD8D8D8D8UL, 0x66666666UL,
    0xD7D7D7D7UL, 0x3A3A3A3AUL, 0xC8C8C8C8UL, 0x3C3C3C3CUL,
    0xFAFAFAFAUL, 0x96969696UL, 0xA7A7A7A7UL, 0x98989898UL,
    0xECECECECUL, 0xB8B8B8B8UL, 0xC7C7C7C7UL, 0xAEAEAEAEUL,
    0x69696969UL, 0x4B4B4B4BUL, 0xABABABABUL, 0xA9A9A9A9UL,
    0x67676767UL, 0x0A0A0A0AUL, 0x47474747UL, 0xF2F2F2F2UL,
    0xB5B5B5B5UL, 0x22222222UL, 0xE5E5E5E5UL, 0xEEEEEEEEUL,
    0xBEBEBEBEUL, 0x2B2B2B2BUL, 0x81818181UL, 0x12121212UL,
    0x83838383UL, 0x1B1B1B1BUL, 0x0E0E0E0EUL, 0x23232323UL,
    0xF5F5F5F5UL, 0x45454545UL, 0x21212121UL, 0xCECECECEUL,
    0x49494949UL, 0x2C2C2C2CUL, 0xF9F9F9F9UL, 0xE6E6E6E6UL,
    0xB6B6B6B6UL, 0x28282828UL, 0x17171717UL, 0x82828282UL,
    0x1A1A1A1AUL, 0x8B8B8B8BUL, 0xFEFEFEFEUL, 0x8A8A8A8AUL,
    0x09090909UL, 0xC9C9C9C9UL, 0x87878787UL, 0x4E4E4E4EUL,
    0xE1E1E1E1UL, 0x2E2E2E2EUL, 0xE4E4E4E4UL, 0xE0E0E0E0UL,
    0xEBEBEBEBUL, 0x90909090UL, 0xA4A4A4A4UL, 0x1E1E1E1EUL,
    0x85858585UL, 0x60606060UL, 0x00000000UL, 0x25252525UL,
    0xF4F4F4F4UL, 0xF1F1F1F1UL, 0x94949494UL, 0x0B0B0B0BUL,
    0xE7E7E7E7UL, 0x75757575UL, 0xEFEFEFEFUL, 0x34343434UL,
    0x31313131UL, 0xD4D4D4D4UL, 0xD0D0D0D0UL, 0x86868686UL,
    0x7E7E7E7EUL, 0xADADADADUL, 0xFDFDFDFDUL, 0x29292929UL,
    0x30303030UL, 0x3B3B3B3BUL, 0x9F9F9F9FUL, 0xF8F8F8F8UL,
    0xC6C6C6C6UL, 0x13131313UL, 0x06060606UL, 0x05050505UL,
    0xC5C5C5C5UL, 0x11111111UL, 0x77777777UL, 0x7C7C7C7CUL,
    0x7A7A7A7AUL, 0x78787878UL, 0x36363636UL, 0x1C1C1C1CUL,
    0x39393939UL, 0x59595959UL, 0x18181818UL, 0x56565656UL,
    0xB3B3B3B3UL, 0xB0B0B0B0UL, 0x24242424UL, 0x20202020UL,
    0xB2B2B2B2UL, 0x92929292UL, 0xA3A3A3A3UL, 0xC0C0C0C0UL,
    0x44444444UL, 0x62626262UL, 0x10101010UL, 0xB4B4B4B4UL,
    0x84848484UL, 0x43434343UL, 0x93939393UL, 0xC2C2C2C2UL,
    0x4A4A4A4AUL, 0xBDBDBDBDUL, 0x8F8F8F8FUL, 0x2D2D2D2DUL,
    0xBCBCBCBCUL, 0x9C9C9C9CUL, 0x6A6A6A6AUL, 0x40404040UL,
    0xCFCFCFCFUL, 0xA2A2A2A2UL, 0x80808080UL, 0x4F4F4F4FUL,
    0x1F1F1F1FUL, 0xCACACACAUL, 0xAAAAAAAAUL, 0x42424242UL,
};

static const int32u _rom_ s_t5[256] =
{
    0x00000000UL, 0x01020608UL, 0x02040C10UL, 0x03060A18UL,
    0x04081820UL, 0x050A1E28UL, 0x060C1430UL, 0x070E1238UL,
    0x08103040UL, 0x09123648UL, 0x0A143C50UL, 0x0B163A58UL,
    0x0C182860UL, 0x0D1A2E68UL, 0x0E1C2470UL, 0x0F1E2278UL,
    0x10206080UL, 0x11226688UL, 0x12246C90UL, 0x13266A98UL,
    0x142878A0UL, 0x152A7EA8UL, 0x162C74B0UL, 0x172E72B8UL,
    0x183050C0UL, 0x193256C8UL, 0x1A345CD0UL, 0x1B365AD8UL,
    0x1C3848E0UL, 0x1D3A4EE8UL, 0x1E3C44F0UL, 0x1F3E42F8UL,
    0x2040C01DUL, 0x2142C615UL, 0x2244CC0DUL, 0x2346CA05UL,
    0x2448D83DUL, 0x254ADE35UL, 0x264CD42DUL, 0x274ED225UL,
    0x2850F05DUL, 0x2952F655UL, 0x2A54FC4DUL, 0x2B56FA45UL,
    0x2C58E87DUL, 0x2D5AEE75UL, 0x2E5CE46DUL, 0x2F5EE265UL,
    0x3060A09DUL, 0x3162A695UL, 0x3264AC8DUL, 0x3366AA85UL,
    0x3468B8BDUL, 0x356ABEB5UL, 0x366CB4ADUL, 0x376EB2A5UL,
    0x387090DDUL, 0x397296D5UL, 0x3A749CCDUL, 0x3B769AC5UL,
    0x3C7888FDUL, 0x3D7A8EF5UL, 0x3E7C84EDUL, 0x3F7E82E5UL,
    0x40809D3AUL, 0x41829B32UL, 0x4284912AUL, 0x43869722UL,
    0x4488851AUL, 0x458A8312UL, 0x468C890AUL, 0x478E8F02UL,
    0x4890AD7AUL, 0x4992AB72UL, 0x4A94A16AUL, 0x4B96A762UL,
    0x4C98B55AUL, 0x4D9AB352UL, 0x4E9CB94AUL, 0x4F9EBF42UL,
    0x50A0FDBAUL, 0x51A2FBB2UL, 0x52A4F1AAUL, 0x53A6F7A2UL,
    0x54A8E59AUL, 0x55AAE392UL, 0x56ACE98AUL, 0x57AEEF82UL,
    0x58B0CDFAUL, 0x59B2CBF2UL, 0x5AB4C1EAUL, 0x5BB6C7E2UL,
    0x5CB8D5DAUL, 0x5DBAD3D2UL, 0x5EBCD9CAUL, 0x5FBEDFC2UL,
    0x60C05D27UL, 0x61C25B2FUL, 0x62C45137UL, 0x63C6573FUL,
    0x64C84507UL, 0x65CA430FUL, 0x66CC4917UL, 0x67CE4F1FUL,
    0x68D06D67UL, 0x69D26B6FUL, 0x6AD46177UL, 0x6BD6677FUL,
    0x6CD87547UL, 0x6DDA734FUL, 0x6EDC7957UL, 0x6FDE7F5FUL,
    0x70E03DA7UL, 0x71E23BAFUL, 0x72E431B7UL, 0x73E637BFUL,
    0x74E82587UL, 0x75EA238FUL, 0x76EC2997UL, 0x77EE2F9FUL,
    0x78F00DE7UL, 0x79F20BEFUL, 0x7AF401F7UL, 0x7BF607FFUL,
    0x7CF815C7UL, 0x7DFA13CFUL, 0x7EFC19D7UL, 0x7FFE1FDFUL,
    0x801D2774UL, 0x811F217CUL, 0x82192B64UL, 0x831B2D6CUL,
    0x84153F54UL, 0x8517395CUL, 0x86113344UL, 0x8713354CUL,
    0x880D1734UL, 0x890F113CUL, 0x8A091B24UL, 0x8B0B1D2CUL,
    0x8C050F14UL, 0x8D07091CUL, 0x8E010304UL, 0x8F03050CUL,
    0x903D47F4UL, 0x913F41FCUL, 0x92394BE4UL, 0x933B4DECUL,
    0x94355FD4UL, 0x953759DCUL, 0x963153C4UL, 0x973355CCUL,
    0x982D77B4UL, 0x992F71BCUL, 0x9A297BA4UL, 0x9B2B7DACUL,
    0x9C256F94UL, 0x9D27699CUL, 0x9E216384UL, 0x9F23658CUL,
    0xA05DE769UL, 0xA15FE161UL, 0xA259EB79UL, 0xA35BED71UL,
    0xA455FF49UL, 0xA557F941UL, 0xA651F359UL, 0xA753F551UL,
    0xA84DD729UL, 0xA94FD121UL, 0xAA49DB39UL, 0xAB4BDD31UL,
    0xAC45CF09UL, 0xAD47C901UL, 0xAE41C319UL, 0xAF43C511UL,
    0xB07D87E9UL, 0xB17F81E1UL, 0xB2798BF9UL, 0xB37B8DF1UL,
    0xB4759FC9UL, 0xB57799C1UL, 0xB67193D9UL, 0xB77395D1UL,
    0xB86DB7A9UL, 0xB96FB1A1UL, 0xBA69BBB9UL, 0xBB6BBDB1UL,
    0xBC65AF89UL, 0xBD67A981UL, 0xBE61A399UL, 0xBF63A591UL,
    0xC09DBA4EUL, 0xC19FBC46UL, 0xC299B65EUL, 0xC39BB056UL,
    0xC495A26EUL, 0xC597A466UL, 0xC691AE7EUL, 0xC793A876UL,
    0xC88D8A0EUL, 0xC98F8C06UL, 0xCA89861EUL, 0xCB8B8016UL,
    0xCC85922EUL, 0xCD879426UL, 0xCE819E3EUL, 0xCF839836UL,
    0xD0BDDACEUL, 0xD1BFDCC6UL, 0xD2B9D6DEUL, 0xD3BBD0D6UL,
    0xD4B5C2EEUL, 0xD5B7C4E6UL, 0xD6B1CEFEUL, 0xD7B3C8F6UL,
    0xD8ADEA8EUL, 0xD9AFEC86UL, 0xDAA9E69EUL, 0xDBABE096UL,
    0xDCA5F2AEUL, 0xDDA7F4A6UL, 0xDEA1FEBEUL, 0xDFA3F8B6UL,
    0xE0DD7A53UL, 0xE1DF7C5BUL, 0xE2D97643UL, 0xE3DB704BUL,
    0xE4D56273UL, 0xE5D7647BUL, 0xE6D16E63UL, 0xE7D3686BUL,
    0xE8CD4A13UL, 0xE9CF4C1BUL, 0xEAC94603UL, 0xEBCB400BUL,
    0xECC55233UL, 0xEDC7543BUL, 0xEEC15E23UL, 0xEFC3582BUL,
    0xF0FD1AD3UL, 0xF1FF1CDBUL, 0xF2F916C3UL, 0xF3FB10CBUL,
    0xF4F502F3UL, 0xF5F704FBUL, 0xF6F10EE3UL, 0xF7F308EBUL,
    0xF8ED2A93UL, 0xF9EF2C9BUL, 0xFAE92683UL, 0xFBEB208BUL,
    0xFCE532B3UL, 0xFDE734BBUL, 0xFEE13EA3UL, 0xFFE338ABUL,
};

static const int32u _rom_ s_rc[] =
{
    0xBA542F74UL, 0x53D3D24DUL, 0x50AC8DBFUL, 0x70529A4CUL,
    0xEAD597D1UL, 0x33515BA6UL, 0xDE48A899UL, 0xDB32B7FCUL,
    0xE39E919BUL, 0xE2BB416EUL, 0xA5CB6B95UL, 0xA1F3B102UL,
    0xCCC41D14UL, 0xC363DA5DUL, 0x5FDC7DCDUL, 0x7F5A6C5CUL,
    0xF726FFEDUL, 0xE89D6F8EUL, 0x19A0F089UL,
};

/* ANUBIS 计算宏 */
#define ANUBIS_MAX_N            10
#define ANUBIS_MAX_ROUNDS   (8 + ANUBIS_MAX_N)

/*
---------------------------------------
    ANUBIS 加密解密
---------------------------------------
*/
static void_t
anubis_crypt (
  __CR_IN__ int32u          key[ANUBIS_MAX_ROUNDS + 1][4],
  __CR_OT__ byte_t*         cipher_text,
  __CR_IN__ const byte_t*   plain_text,
  __CR_IN__ uint_t          round
    )
{
    uint_t  idx, pos;
    int32u  state[4];
    int32u  inter[4];

    for (idx = 0, pos = 0; idx < 4; idx++, pos += 4)
    {
        state[idx] = (plain_text[pos + 0] << 24) ^
                     (plain_text[pos + 1] << 16) ^
                     (plain_text[pos + 2] <<  8) ^
                     (plain_text[pos + 3] <<  0) ^ key[0][idx];
    }

    for (idx = 1; idx < round; idx++)
    {
        inter[0] = s_t0[(state[0] >> 24)       ] ^
                   s_t1[(state[1] >> 24)       ] ^
                   s_t2[(state[2] >> 24)       ] ^
                   s_t3[(state[3] >> 24)       ] ^ key[idx][0];
        inter[1] = s_t0[(state[0] >> 16) & 0xFF] ^
                   s_t1[(state[1] >> 16) & 0xFF] ^
                   s_t2[(state[2] >> 16) & 0xFF] ^
                   s_t3[(state[3] >> 16) & 0xFF] ^ key[idx][1];
        inter[2] = s_t0[(state[0] >>  8) & 0xFF] ^
                   s_t1[(state[1] >>  8) & 0xFF] ^
                   s_t2[(state[2] >>  8) & 0xFF] ^
                   s_t3[(state[3] >>  8) & 0xFF] ^ key[idx][2];
        inter[3] = s_t0[(state[0] >>  0) & 0xFF] ^
                   s_t1[(state[1] >>  0) & 0xFF] ^
                   s_t2[(state[2] >>  0) & 0xFF] ^
                   s_t3[(state[3] >>  0) & 0xFF] ^ key[idx][3];

        state[0] = inter[0];
        state[1] = inter[1];
        state[2] = inter[2];
        state[3] = inter[3];
    }

    inter[0] = (s_t0[(state[0] >> 24)       ] & 0xFF000000UL) ^
               (s_t1[(state[1] >> 24)       ] & 0x00FF0000UL) ^
               (s_t2[(state[2] >> 24)       ] & 0x0000FF00UL) ^
               (s_t3[(state[3] >> 24)       ] & 0x000000FFUL) ^ key[idx][0];
    inter[1] = (s_t0[(state[0] >> 16) & 0xFF] & 0xFF000000UL) ^
               (s_t1[(state[1] >> 16) & 0xFF] & 0x00FF0000UL) ^
               (s_t2[(state[2] >> 16) & 0xFF] & 0x0000FF00UL) ^
               (s_t3[(state[3] >> 16) & 0xFF] & 0x000000FFUL) ^ key[idx][1];
    inter[2] = (s_t0[(state[0] >>  8) & 0xFF] & 0xFF000000UL) ^
               (s_t1[(state[1] >>  8) & 0xFF] & 0x00FF0000UL) ^
               (s_t2[(state[2] >>  8) & 0xFF] & 0x0000FF00UL) ^
               (s_t3[(state[3] >>  8) & 0xFF] & 0x000000FFUL) ^ key[idx][2];
    inter[3] = (s_t0[(state[0] >>  0) & 0xFF] & 0xFF000000UL) ^
               (s_t1[(state[1] >>  0) & 0xFF] & 0x00FF0000UL) ^
               (s_t2[(state[2] >>  0) & 0xFF] & 0x0000FF00UL) ^
               (s_t3[(state[3] >>  0) & 0xFF] & 0x000000FFUL) ^ key[idx][3];

    for (idx = 0, pos = 0; idx < 4; idx++, pos += 4)
    {
        cipher_text[pos + 0] = (uchar)(inter[idx] >> 24);
        cipher_text[pos + 1] = (uchar)(inter[idx] >> 16);
        cipher_text[pos + 2] = (uchar)(inter[idx] >>  8);
        cipher_text[pos + 3] = (uchar)(inter[idx] >>  0);
    }
}

/*
=======================================
    ANUBIS 设置密钥
=======================================
*/
CR_API void_t
crypto_anubis_key (
  __CR_OT__ sANUBIS*        ctx,
  __CR_IN__ const void_t*   key,
  __CR_IN__ leng_t          keylen
    )
{
    byte_t  padded_key[16];
    int32u  k0, k1, k2, k3;
    uint_t  nn, rr, ii, jj, pos;
    int32u  kappa[ANUBIS_MAX_N];
    int32u  inter[ANUBIS_MAX_N];

    if      (keylen >= 40) pos = 40;
    else if (keylen >= 36) pos = 36;
    else if (keylen >= 32) pos = 32;
    else if (keylen >= 28) pos = 28;
    else if (keylen >= 24) pos = 24;
    else if (keylen >= 20) pos = 20;
    else if (keylen >= 16) pos = 16;
    else
    {
        pos = 16;   /* 填充到16B */
        mem_set(padded_key, 0x00, 16);
        key = mem_cpy(padded_key, key, keylen);
    }

    nn = (pos * 8) / 32;
    ctx->round = rr = 8 + nn;

    for (ii = 0, pos = 0; ii < nn; ii++, pos += 4)
    {
        kappa[ii] = (((uchar*)key)[pos + 0] << 24) ^
                    (((uchar*)key)[pos + 1] << 16) ^
                    (((uchar*)key)[pos + 2] <<  8) ^
                    (((uchar*)key)[pos + 3] <<  0);
    }

    for (pos = 0; pos <= rr; pos++)
    {
        k0 = s_t4[(kappa[nn - 1] >> 24)       ];
        k1 = s_t4[(kappa[nn - 1] >> 16) & 0xFF];
        k2 = s_t4[(kappa[nn - 1] >>  8) & 0xFF];
        k3 = s_t4[(kappa[nn - 1] >>  0) & 0xFF];

        for (ii = nn - 2; ii != 0; ii--)
        {
            k0 = (s_t4[(kappa[ii] >> 24)       ]) ^
                 (s_t5[(k0 >> 24)       ] & 0xFF000000UL) ^
                 (s_t5[(k0 >> 16) & 0xFF] & 0x00FF0000UL) ^
                 (s_t5[(k0 >>  8) & 0xFF] & 0x0000FF00UL) ^
                 (s_t5[(k0 >>  0) & 0xFF] & 0x000000FFUL);

            k1 = (s_t4[(kappa[ii] >> 16) & 0xFF]) ^
                 (s_t5[(k1 >> 24)       ] & 0xFF000000UL) ^
                 (s_t5[(k1 >> 16) & 0xFF] & 0x00FF0000UL) ^
                 (s_t5[(k1 >>  8) & 0xFF] & 0x0000FF00UL) ^
                 (s_t5[(k1 >>  0) & 0xFF] & 0x000000FFUL);

            k2 = (s_t4[(kappa[ii] >>  8) & 0xFF]) ^
                 (s_t5[(k2 >> 24)       ] & 0xFF000000UL) ^
                 (s_t5[(k2 >> 16) & 0xFF] & 0x00FF0000UL) ^
                 (s_t5[(k2 >>  8) & 0xFF] & 0x0000FF00UL) ^
                 (s_t5[(k2 >>  0) & 0xFF] & 0x000000FFUL);

            k3 = (s_t4[(kappa[ii] >>  0) & 0xFF]) ^
                 (s_t5[(k3 >> 24)       ] & 0xFF000000UL) ^
                 (s_t5[(k3 >> 16) & 0xFF] & 0x00FF0000UL) ^
                 (s_t5[(k3 >>  8) & 0xFF] & 0x0000FF00UL) ^
                 (s_t5[(k3 >>  0) & 0xFF] & 0x000000FFUL);
        }

        ctx->e[pos][0] = k0;
        ctx->e[pos][1] = k1;
        ctx->e[pos][2] = k2;
        ctx->e[pos][3] = k3;

        if (pos != rr)
        {
            for (ii = 0; ii < nn; ii++)
            {
                jj = ii;
                inter[ii]  = s_t0[(kappa[jj--] >> 24)       ];

                if ((sint_t)jj < 0)
                    jj = nn - 1;
                inter[ii] ^= s_t1[(kappa[jj--] >> 16) & 0xFF];

                if ((sint_t)jj < 0)
                    jj = nn - 1;
                inter[ii] ^= s_t2[(kappa[jj--] >>  8) & 0xFF];

                if ((sint_t)jj < 0)
                    jj = nn - 1;
                inter[ii] ^= s_t3[(kappa[jj+0] >>  0) & 0xFF];
            }
            kappa[0] = inter[0] ^ s_rc[pos];
            for (ii = 1; ii < nn; ii++)
                kappa[ii] = inter[ii];
        }
    }

    for (ii = 0; ii < 4; ii++)
    {
        ctx->d[ 0][ii] = ctx->e[rr][ii];
        ctx->d[rr][ii] = ctx->e[ 0][ii];
    }

    for (jj = 1; jj < rr; jj++)
    for (ii = 0; ii <  4; ii++)
    {
        k0 = ctx->e[rr - jj][ii];

        ctx->d[jj][ii] = s_t0[s_t4[(k0 >> 24)       ] & 0xFF] ^
                         s_t1[s_t4[(k0 >> 16) & 0xFF] & 0xFF] ^
                         s_t2[s_t4[(k0 >>  8) & 0xFF] & 0xFF] ^
                         s_t3[s_t4[(k0 >>  0) & 0xFF] & 0xFF];
    }
}

/*
=======================================
    ANUBIS 加密
=======================================
*/
CR_API void_t
crypto_anubis_enc (
  __CR_IO__ sANUBIS*        ctx,
  __CR_OT__ int32u          dst[4],
  __CR_IN__ const int32u    src[4]
    )
{
    anubis_crypt(ctx->e, (uchar*)dst, (const uchar*)src, ctx->round);
}

/*
=======================================
    ANUBIS 解密
=======================================
*/
CR_API void_t
crypto_anubis_dec (
  __CR_IO__ sANUBIS*        ctx,
  __CR_OT__ int32u          dst[4],
  __CR_IN__ const int32u    src[4]
    )
{
    anubis_crypt(ctx->d, (uchar*)dst, (const uchar*)src, ctx->round);
}

/*****************************************************************************/
/* _________________________________________________________________________ */
/* uBMAzRBoAKAHaACQD6FoAIAPqbgA/7rIA+5CM9uKw8D4Au7u7mSIJ0t18mYz0mYz9rAQZCgHc */
/* wRIZIgHZovGBXUAZg+v0GbB+gRmgcJ7BAAAisIlAwB1Av7LSHUC/s9IdQL+w0h1Av7HZkZmgf */
/* 4JLgIAdb262gPsqAh0+zP/uQB9ZYsFZYktq+L3sMi/AAK7gAKJAUtLdfq5IANXvT8BiQzfBIv */
/* FLaAAweAEmff53wb+Adjx3kQE2xwy5Io8ithkigcFgACJBN8E3sneNvwB2xyLHDkdfA2JHSyA */
/* adtAAQPdZYgHR0dNdbZfSYP5UHWr/kQEtAHNFg+Eef/DWAKgDw== |~~~~~~~~~~~~~~~~~~~ */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ >>> END OF FILE <<< */
/*****************************************************************************/
